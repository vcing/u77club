<div class="room" ng-class="{true:'sidebar-open'}[roomSidebarToggle]">
	<div class="chat">
		<div class="header">		
			<div class="meta">
				<h2 class="heading">
					<span class="name">{{room.name}}</span>
					<button ng-click='showNewActive()'>发动态</button>
				</h2>
				<div class="description">{{room.description}}</div>
			</div>
			<div class="actions">
				<a class="sidebar-toggle" ng-click='roomSidebarToggle=!roomSidebarToggle'>
					<i class="fa fa-chevron-left"></i>
				</a>
			</div>
		</div>
		<ul class="messages" mlsh>
			<li id="m_{{message._id}}" class="message {{message.class}}" ng-repeat='message in messageList'>
				<div ng-if="!message.active">
				<!-- 普通消息 -->
					<img class='avatar' ng-src="http://img.u77.com/avatar/{{message.sender.avatar}}!avatar" ng-click='openPrivateMessage(message.sender._id)'>
					<div class="content">
						<span class='name' ng-click='openPrivateMessage(message.sender._id)'>{{message.sender.nickname}}</span>
						<span class='time'>{{message.date | dateFromNow}}</span>
						<div class="text" ng-bind-html="message.content | html"></div>
					</div>
				</div>
				<div ng-if="message.active && message.content">
				<!-- 回复动态 -->
					<img class='avatar' ng-src="http://img.u77.com/avatar/{{message.sender.avatar}}!avatar" ng-click='openPrivateMessage(message.sender._id)'>
					<div class="content">
						<span class='name' ng-click='openPrivateMessage(message.sender._id)'>{{message.sender.nickname}}</span>
						<span class='time'>{{message.date | dateFromNow}}</span>
						<div class="text" ng-bind-html="message.content | html"></div>
					</div>
					<div class="block" style="margin-left:40px">
						<div class="top">
							<div class='avatar'><img width="50" height="50" ng-src="http://img.u77.com/avatar/{{message.sender.avatar}}!avatar"></div>
							<div class="detail">
								<div class="author">
									<a class="nickname" ng-bind="message.sender.nickname"></a>
									<a class="title"></a>
								</div>
								<div class="content" ng-bind="message.active.content"></div>
								<span class="time" ng-bind="message.active.date|dateFromNow"></span>
							</div>
						</div>
						<div class="bottom">
							<a >收藏</a>
							<a >转发</a>
							<a ng-click="message.active.showComment=!message.active.showComment;getComment(message.active)">评论</a>
							<a >点赞</a>
						</div>
						<div class="comment" ng-class="{true:'show'}[message.active.showComment]">
							<textarea atwho ng-model="message.active.comment"></textarea>
							<a class="btn btn-warning submit" ng-click='sendComment(message.active,message.active.comment)'>评论</a>
							<ul class="list">
								<li ng-repeat="comment in message.active.comments">
									<div class="avatar">
										<img width="30" height="30" ng-src="http://img.u77.com/avatar/{{comment.sender.avatar}}!avatar">
									</div>
									<div class="detail">
										<div class="content">
											<span class="author" ng-bind="comment.sender.nickname"></span>：{{comment.content}}
										</div>
										<div class="info">
											<span class='time'>{{comment.date|dateFromNow}}</span>
											<div class="buttons" ng-if="self._id != comment.sender._id">
												<a href="">举报</a>
												<a href="">回复</a>
												<a href="">点赞</a>
											</div>
										</div>
									</div>
								</li>
							</ul>
						</div>
					</div>

				</div>
				<div ng-if="message.active && !message.content">
				<!-- 新动态 -->
					<div class="block" >
						<div class="top">
							<div class='avatar'><img width="50" height="50" ng-src="http://img.u77.com/avatar/{{message.sender.avatar}}!avatar"></div>
							<div class="detail">
								<div class="author">
									<a class="nickname" ng-bind="message.sender.nickname"></a>
									<a class="title"></a>
								</div>
								<div class="content" ng-bind="message.active.content"></div>
								<span class="time" ng-bind="message.active.date|dateFromNow"></span>
							</div>
						</div>
						<div class="bottom">
							<a >收藏</a>
							<a >转发</a>
							<a ng-click="message.active.showComment=!message.active.showComment;getComment(message.active)">评论</a>
							<a >点赞</a>
						</div>
						<div class="comment" ng-class="{true:'show'}[message.active.showComment]">
							<textarea atwho ng-model="message.active.comment"></textarea>
							<a class="btn btn-warning submit" ng-click='sendComment(message.active,message.active.comment)'>评论</a>
							<ul class="list">
								<li ng-repeat="comment in message.active.comments">
									<div class="avatar">
										<img width="30" height="30" ng-src="http://img.u77.com/avatar/{{comment.sender.avatar}}!avatar">
									</div>
									<div class="detail">
										<div class="content">
											<span class="author" ng-bind="comment.sender.nickname"></span>：{{comment.content}}
										</div>
										<div class="info">
											<span class='time'>{{comment.date|dateFromNow}}</span>
											<div class="buttons" ng-if="self._id != comment.sender._id">
												<a href="">举报</a>
												<a href="">回复</a>
												<a href="">点赞</a>
											</div>
										</div>
									</div>
								</li>
							</ul>
						</div>
					</div>



				</div>
			</li>
		</ul>
		<div class="editor">
			<textarea atwho class="input" ng-model='text'></textarea>
			<button type="submit" class="btn btn-info submit" ng-click='send()'>发送</button>
		</div>
	</div>
	<div class="sidebar" sidebar-handle>
		<div class="header">
			<ul>
				<li class="actives"  ng-class="{'actives':'active'}[active]" ng-click="active='actives'">
					<h3>动态</h3>
				</li>
				<li class='users' ng-class="{'users':'active'}[active]" ng-click="active='users'">
					<h3>
						<i class="fa fa-users"></i>在线(<span class='online-count' ng-bind='onlineCount'></span>)
					</h3>
				</li>
			</ul>
			
		</div>
		<div class="wraper">
			<div class="group actives" active-list>
				
			</div>
			<div class="group users">
				<ul class="list">
					<li class="item user" ng-repeat='user in onlineList' ng-click='openPrivateMessage(user._id)'>
				        <img class="avatar" ng-src="http://img.u77.com/avatar/{{user.avatar}}!avatar">
				        <div class="info">
				            <span class="nickname" ng-bind='user.nickname'></span>
				        </div>
				    </li>
				</ul>
			</div>
		</div>
	</div>
</div>